From a00de7576695e8d995336236d0575be138d87cbb Mon Sep 17 00:00:00 2001
From: alanranger <info@alanranger.com>
Date: Tue, 23 Dec 2025 14:50:41 +0000
Subject: [PATCH] Fix CTR delta formatting: Convert ratio delta to percentage
 points (0.001 -> +0.10pp) instead of showing raw ratio

---
 audit-dashboard.html | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/audit-dashboard.html b/audit-dashboard.html
index 1edbbcc..8d69404 100644
--- a/audit-dashboard.html
+++ b/audit-dashboard.html
@@ -11715,6 +11715,15 @@ <h3>üîç Debug Log</h3>
       // Helper to format delta with color (handles rank where lower is better)
       const formatDelta = (delta, metricKey) => {
         if (delta == null) return { text: '‚Äî', color: '#666' };
+        // For CTR, delta is in ratio format (0-1), convert to percentage points
+        if (metricKey === 'gsc_ctr_28d' || metricKey === 'ctr_28d') {
+          const deltaPp = delta * 100; // Convert ratio delta to percentage points
+          const sign = deltaPp >= 0 ? '+' : '';
+          const formatted = `${sign}${deltaPp.toFixed(2)}pp`;
+          if (deltaPp > 0) return { text: formatted, color: '#10b981' }; // Up - green
+          if (deltaPp < 0) return { text: formatted, color: '#ef4444' }; // Down - red
+          return { text: '0.00pp', color: '#f59e0b' }; // No change - amber
+        }
         // For rank, lower is better (negative delta means improved rank = good)
         if (metricKey === 'current_rank') {
           const absDelta = Math.abs(delta);
