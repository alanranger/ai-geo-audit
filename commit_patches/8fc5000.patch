From 8fc5000d96c4f9a666308de92ead8e2f14efd7c8 Mon Sep 17 00:00:00 2001
From: alanranger <info@alanranger.com>
Date: Tue, 23 Dec 2025 16:11:42 +0000
Subject: [PATCH] Add Suggested (Top 10) section back to Money Pages module -
 displays top 10 priority pages as cards

---
 audit-dashboard.html | 121 +++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 121 insertions(+)

diff --git a/audit-dashboard.html b/audit-dashboard.html
index 929639c..04b46b8 100644
--- a/audit-dashboard.html
+++ b/audit-dashboard.html
@@ -15163,6 +15163,11 @@ <h3>üîç Debug Log</h3>
           if (typeof window.wirePriorityActionsFilters === 'function') {
             window.wirePriorityActionsFilters();
           }
+          
+          // Render Suggested (Top 10) cards
+          if (typeof window.renderMoneyPagesSuggestedTop10 === 'function') {
+            window.renderMoneyPagesSuggestedTop10();
+          }
         }, 100);
       }
 
@@ -27375,6 +27380,20 @@ <h3 style="margin: 0 0 0.5rem 0; font-size: 1.1rem; font-weight: 700; color: #1e
               </div>
             </section>
             
+            <!-- Suggested (Top 10) Section -->
+            <section id="money-pages-suggested-top10" class="card card--full" style="margin-top: 2rem; background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
+              <div class="card-header" style="margin-bottom: 1rem;">
+                <h3 style="margin: 0 0 0.5rem 0; font-size: 1.1rem; font-weight: 700; color: #1e293b;">Suggested (Top 10)</h3>
+                <p class="card-subtitle" style="margin: 0; font-size: 0.85rem; color: #64748b; line-height: 1.6;">
+                  Top priority pages ranked by impact and difficulty. Click 'Create Task' to start optimization tracking.
+                </p>
+              </div>
+              
+              <div id="money-pages-suggested-cards" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;">
+                <!-- Suggested cards will be rendered here by JS -->
+              </div>
+            </section>
+            
             <p class="card-footnote" style="margin-top: 1rem; font-size: 0.85rem; color: #666;">
               Based on the current audit date range and money-page segment only.
               Categories and actions are data-driven and will update each time you run a new audit.
@@ -30593,6 +30612,108 @@ <h3 style="margin: 0 0 1rem 0; font-size: 1.25rem; font-weight: 700; color: #1e2
       // Make function globally available
       window.wirePriorityActionsFilters = wirePriorityActionsFilters;
       
+      // Render Suggested (Top 10) cards
+      window.renderMoneyPagesSuggestedTop10 = function() {
+        const container = document.getElementById('money-pages-suggested-cards');
+        if (!container) {
+          debugLog('‚ö† money-pages-suggested-cards container not found', 'warn');
+          return;
+        }
+        
+        const priorityData = window.moneyPagePriorityData || [];
+        if (!priorityData || priorityData.length === 0) {
+          container.innerHTML = '<p style="padding: 2rem; text-align: center; color: #64748b;">No priority data available. Run an audit to generate suggestions.</p>';
+          return;
+        }
+        
+        // Sort by impact score (descending) and take top 10
+        const top10 = [...priorityData]
+          .sort((a, b) => {
+            // Sort by impact score (higher is better)
+            const impactA = a.impactScore || 0;
+            const impactB = b.impactScore || 0;
+            if (impactB !== impactA) return impactB - impactA;
+            // If impact is same, sort by difficulty (lower is better)
+            const diffOrder = { LOW: 0, MEDIUM: 1, HIGH: 2 };
+            return (diffOrder[a.difficultyLevel] || 2) - (diffOrder[b.difficultyLevel] || 2);
+          })
+          .slice(0, 10);
+        
+        if (top10.length === 0) {
+          container.innerHTML = '<p style="padding: 2rem; text-align: center; color: #64748b;">No suggestions available.</p>';
+          return;
+        }
+        
+        container.innerHTML = top10.map((page, index) => {
+          const isOptimized = page.optimisationStatus === 'on_page' || page.optimisationStatus === 'tracking';
+          const difficultyColors = { LOW: '#10b981', MEDIUM: '#f59e0b', HIGH: '#ef4444' };
+          const difficultyColor = difficultyColors[page.difficultyLevel] || '#64748b';
+          const impactScore = page.impactScore || 0;
+          
+          return `
+            <div class="suggested-card" style="background: white; border: 2px solid #e2e8f0; border-radius: 8px; padding: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
+              <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
+                <div style="flex: 1;">
+                  <h4 style="margin: 0 0 0.5rem 0; font-size: 1rem; font-weight: 700; color: #1e293b; line-height: 1.4;">${page.title || page.url || 'Untitled Page'}</h4>
+                  <a href="${page.url}" target="_blank" style="font-size: 0.85rem; color: #2563eb; text-decoration: none; word-break: break-all;">${page.url}</a>
+                </div>
+                ${isOptimized ? '<span style="padding: 0.25rem 0.75rem; background: #10b981; color: white; border-radius: 4px; font-size: 0.75rem; font-weight: 600; white-space: nowrap;">‚úì Being Optimised</span>' : ''}
+              </div>
+              
+              <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap;">
+                <span style="padding: 0.25rem 0.5rem; background: #f1f5f9; border-radius: 4px; font-size: 0.75rem; color: #64748b; text-transform: uppercase;">${page.segmentType || 'landing'}</span>
+                <span style="padding: 0.25rem 0.5rem; background: ${difficultyColor}20; color: ${difficultyColor}; border-radius: 4px; font-size: 0.75rem; font-weight: 600;">${page.difficultyLevel || 'MED'}</span>
+              </div>
+              
+              <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem; margin-bottom: 1rem; font-size: 0.85rem;">
+                <div>
+                  <div style="color: #64748b; margin-bottom: 0.25rem;">Pos:</div>
+                  <div style="font-weight: 700; color: #1e293b;">${(page.avgPosition || 0).toFixed(1)}</div>
+                </div>
+                <div>
+                  <div style="color: #64748b; margin-bottom: 0.25rem;">CTR:</div>
+                  <div style="font-weight: 700; color: #1e293b;">${((page.ctr || 0) * 100).toFixed(1)}%</div>
+                </div>
+                <div>
+                  <div style="color: #64748b; margin-bottom: 0.25rem;">Impr:</div>
+                  <div style="font-weight: 700; color: #1e293b;">${(page.impressions || 0).toLocaleString()}</div>
+                </div>
+                <div>
+                  <div style="color: #64748b; margin-bottom: 0.25rem;">Upside:</div>
+                  <div style="font-weight: 700; color: #1e293b;">${page.potentialClicks28d || 0}</div>
+                </div>
+                <div>
+                  <div style="color: #64748b; margin-bottom: 0.25rem;">Impact:</div>
+                  <div style="font-weight: 700; color: #1e293b;">${Math.round(impactScore)}</div>
+                </div>
+                <div>
+                  <div style="color: #64748b; margin-bottom: 0.25rem;">Difficulty:</div>
+                  <div style="font-weight: 700; color: ${difficultyColor};">${page.difficultyLevel || 'MED'}</div>
+                </div>
+              </div>
+              
+              <div style="margin-bottom: 1rem; padding: 0.75rem; background: #f8fafc; border-radius: 4px; font-size: 0.85rem; color: #475569;">
+                <strong>Potential impact clicks 28d:</strong> ${page.potentialClicks28d || 0}
+              </div>
+              
+              <div style="margin-bottom: 1rem; font-size: 0.85rem; color: #64748b; line-height: 1.5;">
+                ${page.suggestion || (page.impactLevel === 'HIGH' && page.difficultyLevel === 'LOW' ? 'Improve relevance + internal links to lift rank' : 'Improve CTR (title/meta/snippet) + strengthen content')}
+              </div>
+              
+              <button 
+                type="button" 
+                class="btn ${isOptimized ? 'btn-secondary' : 'btn-primary'}" 
+                onclick="${isOptimized ? `window.location.href='#optimisation'` : `window.createOptimisationTask('${page.url}', '', '${page.url}')`}"
+                style="width: 100%; padding: 0.75rem; background: ${isOptimized ? '#64748b' : '#2563eb'}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 0.875rem;">
+                ${isOptimized ? 'Manage Task' : 'Create Task'}
+              </button>
+            </div>
+          `;
+        }).join('');
+        
+        debugLog(`‚úì Rendered ${top10.length} suggested top 10 cards`, 'success');
+      };
+      
       // ============================================================================
       // 12-Month KPI Tracker Functions
       // ============================================================================
